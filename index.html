<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Shadi Piscine - R√©servation & Admin</title>
<style>
body { font-family: Arial; transition:0.3s; background:#f4f4f4; color:#000; }
.dark-mode { background:#121212; color:#fff; }
.container { max-width:600px; margin:auto; padding:20px; background:white; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1);}
input, button, textarea, select { width:100%; padding:10px; margin:6px 0; border-radius:8px; border:1px solid #ccc; }
button { background:#0077ff; color:white; border:none; cursor:pointer; border-radius:6px; }
button:hover { background:#0055cc; }
.hidden { display:none; }
.calendar { display:grid; grid-template-columns:repeat(7,1fr); gap:5px; margin:10px 0; }
.day, .slot { padding:20px; text-align:center; border-radius:8px; border:1px solid #ccc; cursor:pointer; background:white; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
.day:hover, .slot:hover { background:#cce5ff; }
.day.selected, .slot.selected { border:2px solid #0077ff; }
.day.reserved, .slot.reserved { background:#ccc; color:#666; cursor:not-allowed; }
.attention { background:#ffdddd; border:1px solid #ff5c5c; padding:10px; border-radius:8px; font-weight:bold; color:#a80000; margin-bottom:15px; text-align:center; }
.contact { margin-top:20px; padding:10px; background:#e0f7ff; border:1px solid #00aaff; border-radius:8px; }
.logoutBtn { background:#ff5555; margin-top:10px; }
.logoutBtn:hover { background:#cc0000; }
.createBtn { background:#00aa55; margin-top:10px; }
.createBtn:hover { background:#008833; }
.announcements { background:#fff4cc; padding:10px; border:1px solid #ffcc33; border-radius:8px; margin-top:15px; }
</style>
</head>
<body>

<!-- Connexion utilisateur -->
<div class="container" id="loginDiv">
<h2>Connexion - Shadi Piscine</h2>
<label>Nom d'utilisateur :</label>
<input type="text" id="username">
<label>Mot de passe :</label>
<input type="password" id="password">
<button style="background:red;" onclick="login()">Se connecter</button>
<button class="createBtn" onclick="showCreateDiv()">Cr√©er un compte</button>
<div id="loginError" style="color:red; display:none; margin-top:10px;">Nom ou mot de passe incorrect</div>
</div>

<!-- Cr√©ation compte -->
<div class="container hidden" id="createDiv">
<h2>Cr√©er un compte - Shadi Piscine</h2>
<label>Nom d'utilisateur :</label>
<input type="text" id="newUsername">
<label>Mot de passe :</label>
<input type="password" id="newPassword">
<button onclick="createAccount()">Cr√©er le compte</button>
<div id="createError" style="color:red; display:none; margin-top:10px;"></div>
</div>

<!-- Page client -->
<div class="container hidden" id="resaDiv">
<h2>Shadi Piscine - R√©servation</h2>
<button onclick="toggleMode()">üåô/‚òÄÔ∏è Mode sombre/blanc</button>
<button class="logoutBtn" onclick="logout()">D√©connexion</button>

<div class="attention">
‚ö†Ô∏è Attention, v√©rifiez bien vos informations avant d‚Äôenvoyer !
</div>

<h3>Calendrier</h3>
<div class="calendar" id="calendar"></div>

<!-- Grille horaires -->
<div id="timeSlots" class="hidden">
  <h3>Choisissez un cr√©neau</h3>
  <div class="calendar" id="timeGrid"></div>
</div>

<form id="resaForm">
<label>Nom complet :</label>
<input type="text" name="Nom" required>

<label>Email :</label>
<input type="email" name="Email" required>

<label>Date choisie :</label>
<input type="text" id="selectedDate" name="Date" readonly required>

<label>Message :</label>
<textarea name="Message" rows="4"></textarea>

<button type="submit">R√©server</button>
<button type="button" style="background:#ff5555;" onclick="cancelReservation()">Annuler ma r√©servation</button>
</form>

<div class="contact">
Pour tout contact, veuillez envoyer un email √† <strong>shadi.siteweb@gmail.com</strong>
</div>

<div class="announcements">
<h3>Messages d'annonce</h3>
<ul id="clientAnnouncements"></ul>
</div>
</div>

<script>
// --- Comptes ---
let savedAccount = JSON.parse(localStorage.getItem('account'));
function showCreateOrLogin(){ savedAccount ? loginDivShow() : createDivShow(); }
function loginDivShow(){ document.getElementById('createDiv').classList.add('hidden'); document.getElementById('loginDiv').classList.remove('hidden'); }
function createDivShow(){ document.getElementById('createDiv').classList.remove('hidden'); document.getElementById('loginDiv').classList.add('hidden'); }
function showCreateDiv(){ createDivShow(); }
function createAccount(){
    const u = document.getElementById('newUsername').value.trim();
    const p = document.getElementById('newPassword').value.trim();
    if(u===""||p===""){document.getElementById('createError').textContent="Veuillez remplir tous les champs";document.getElementById('createError').style.display="block";return;}
    savedAccount = {username:u,password:p};
    localStorage.setItem('account', JSON.stringify(savedAccount));
    alert("Compte cr√©√© !");
    showCreateOrLogin();
}

// --- Connexion ---
const adminUser = {username:"admin", password:"admin"};
function login(){
    const u=document.getElementById('username').value.trim();
    const p=document.getElementById('password').value.trim();
    if(u===adminUser.username && p===adminUser.password){ alert("Connect√© comme admin. Utilisez admin.html."); }
    else if(savedAccount && u===savedAccount.username && p===savedAccount.password){
        document.getElementById('loginDiv').classList.add('hidden');
        document.getElementById('resaDiv').classList.remove('hidden');
        generateCalendar();
        displayClientAnnouncements();
    } else { document.getElementById('loginError').style.display='block'; }
}
function logout(){ window.location.reload(); }
function toggleMode(){ document.body.classList.toggle('dark-mode'); }

// --- R√©servations et calendrier ---
let reservations = JSON.parse(localStorage.getItem('reservations')) || [];
let announcements = JSON.parse(localStorage.getItem('announcements')) || [];
let selectedDay=null; let selectedHour=null;

const calendar = document.getElementById('calendar');

function generateCalendar(){
    calendar.innerHTML="";
    for(let day=1;day<=30;day++){
        const div=document.createElement('div'); div.textContent=day; div.className='day';
        div.addEventListener('click',()=>{
            selectedDay=day;
            showTimeSlots(day);
            document.querySelectorAll('.day').forEach(d=>d.classList.remove('selected'));
            div.classList.add('selected');
        });
        calendar.appendChild(div);
    }
}

function showTimeSlots(day, clientName = null){
    const container=document.getElementById('timeSlots'); const grid=document.getElementById('timeGrid');
    container.classList.remove('hidden'); grid.innerHTML="";
    const slots=["09:00","10:30","12:00","13:30","15:00"];
    const nomClient=document.querySelector('input[name="Nom"]').value.trim();
    slots.forEach(hour=>{
        const div=document.createElement('div'); div.textContent=hour; div.className='slot';
        const reserved = reservations.find(r=>r.jour===day && r.heure===hour);
        if(reserved){
            if(reserved.nom===nomClient){ div.classList.remove("reserved"); div.addEventListener('click',()=>{selectedHour=hour; document.getElementById("selectedDate").value=`Jour ${day} - ${hour}`;}); }
            else { div.classList.add("reserved"); }
        } else { div.addEventListener('click',()=>{selectedHour=hour; document.querySelectorAll(".slot").forEach(s=>s.classList.remove("selected")); div.classList.add("selected"); document.getElementById("selectedDate").value=`Jour ${day} - ${hour}`; }); }
        grid.appendChild(div);
    });
}

// --- Formulaire ---
document.getElementById('resaForm').addEventListener('submit',function(e){
    e.preventDefault();
    if(selectedDay===null || selectedHour===null){ alert("S√©lectionnez un jour et un cr√©neau."); return; }
    if(confirm("Confirmer la r√©servation ?")){
        const nom=document.querySelector('input[name="Nom"]').value;
        const email=document.querySelector('input[name="Email"]').value;
        const message=document.querySelector('textarea[name="Message"]').value;
        reservations.push({jour:selectedDay,heure:selectedHour,nom,email,message});
        localStorage.setItem('reservations',JSON.stringify(reservations));
        alert("R√©servation confirm√©e !");
        generateCalendar(); showTimeSlots(selectedDay); selectedDay=null; selectedHour=null; this.reset();
        displayClientAnnouncements();
    }
});

// --- Annuler r√©servation ---
function cancelReservation(){
    const nom=document.querySelector('input[name="Nom"]').value.trim();
    if(!nom){ alert("Entrez votre nom."); return; }
    const filtered = reservations.filter(r=>r.nom===nom);
    if(filtered.length===0){ alert("Vous n'avez pas de r√©servations."); return; }
    const confirmCancel=confirm("Voulez-vous annuler votre r√©servation ?");
    if(confirmCancel){
        reservations=reservations.filter(r=>r.nom!==nom);
        localStorage.setItem('reservations',JSON.stringify(reservations));
        alert("R√©servations annul√©es !");
        generateCalendar();
    }
}

// --- Annonces ---
function displayClientAnnouncements(){
    const ul = document.getElementById('clientAnnouncements');
    ul.innerHTML="";
    const announcements = JSON.parse(localStorage.getItem('announcements')) || [];
    announcements.forEach(a=>{ const li=document.createElement('li'); li.textContent=a; ul.appendChild(li); });
}

showCreateOrLogin();
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Shadi Piscine - Admin</title>
<style>
body { font-family: Arial; background:#f4f4f4; color:#000; transition:0.3s; }
.dark-mode { background:#121212; color:#fff; }
.container { max-width:800px; margin:auto; padding:20px; background:white; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1);}
button { padding:10px 20px; border:none; border-radius:8px; cursor:pointer; margin:5px 0; }
button:hover { opacity:0.85; }
.logoutBtn { background:#ff5555; color:white; }
.logoutBtn:hover { background:#cc0000; }
.blockBtn { background:#0077ff; color:white; }
.blockBtn:hover { background:#0055cc; }
.calendar { display:grid; grid-template-columns:repeat(7,1fr); gap:5px; margin:15px 0; }
.day, .slot { padding:20px; text-align:center; border-radius:8px; border:1px solid #ccc; cursor:pointer; background:white; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
.day:hover, .slot:hover { background:#cce5ff; }
.day.selected, .slot.selected { border:2px solid #0077ff; }
.day.reserved, .slot.reserved { background:#ccc; color:#666; cursor:not-allowed; }
table { width:100%; border-collapse:collapse; margin-top:15px; }
th, td { padding:10px; text-align:center; border:1px solid #ccc; border-radius:6px; }
th { background:#0077ff; color:white; }
tr:nth-child(even) { background:#f0f8ff; }
textarea { width:100%; border-radius:8px; padding:8px; margin:6px 0; }
</style>
</head>
<body>

<!-- Connexion Admin -->
<div class="container" id="loginDiv">
<h2>Connexion Admin - Shadi Piscine</h2>
<label>Nom d'utilisateur :</label>
<input type="text" id="username">
<label>Mot de passe :</label>
<input type="password" id="password">
<button style="background:red;" onclick="login()">Se connecter</button>
<div id="loginError" style="color:red; display:none; margin-top:10px;">Nom ou mot de passe incorrect</div>
</div>

<!-- Admin Dashboard -->
<div class="container hidden" id="adminDiv">
<h2>Admin - Shadi Piscine</h2>
<button onclick="toggleMode()" class="blockBtn">üåô/‚òÄÔ∏è Mode sombre/blanc</button>
<button class="logoutBtn" onclick="logout()">D√©connexion</button>

<h3>Calendrier (Cliquez sur un jour pour g√©rer les cr√©neaux)</h3>
<div class="calendar" id="calendar"></div>

<div id="timeSlots" class="hidden">
  <h3>Cr√©neaux horaires</h3>
  <div class="calendar" id="timeGrid"></div>
</div>

<h3>R√©servations</h3>
<table>
<tr><th>Jour</th><th>Heure</th><th>Nom</th><th>Email</th><th>Message</th><th>Action</th></tr>
<tbody id="adminTable"></tbody>
</table>

<h3>Messages d'annonce</h3>
<textarea id="announcementText" rows="3" placeholder="√âcrire un message..."></textarea>
<button class="blockBtn" onclick="publishAnnouncement()">Publier</button>
<h4>Messages actuels :</h4>
<ul id="announcementList"></ul>

<h3>Message de bienvenue</h3>
<textarea id="welcomeText" rows="2" placeholder="√âcrire le message de bienvenue..."></textarea>
<button class="blockBtn" onclick="setWelcomeMessage()">Enregistrer</button>
<p>Message actuel : <span id="currentWelcome"></span></p>
</div>

<script>
const adminUser = {username:"admin", password:"admin"};
let reservations = JSON.parse(localStorage.getItem('reservations')) || [];
let announcements = JSON.parse(localStorage.getItem('announcements')) || [];
let selectedDay = null;

// --- Connexion ---
function login(){
    const u=document.getElementById('username').value.trim();
    const p=document.getElementById('password').value.trim();
    if(u===adminUser.username && p===adminUser.password){
        document.getElementById('loginDiv').classList.add('hidden');
        document.getElementById('adminDiv').classList.remove('hidden');
        generateCalendar(); generateAdminTable(); displayAnnouncements(); displayWelcomeMessage();
    } else { document.getElementById('loginError').style.display='block'; }
}
function logout(){ window.location.reload(); }
function toggleMode(){ document.body.classList.toggle('dark-mode'); }

// --- Calendrier Admin ---
const calendar = document.getElementById('calendar');
function generateCalendar(){
    calendar.innerHTML="";
    for(let day=1;day<=30;day++){
        const div=document.createElement('div'); div.textContent=day; div.className='day';
        div.addEventListener('click',()=>{ selectedDay=day; showTimeSlots(day); document.querySelectorAll('.day').forEach(d=>d.classList.remove('selected')); div.classList.add('selected'); });
        calendar.appendChild(div);
    }
}

// --- Grille horaires ---
function showTimeSlots(day){
    const container=document.getElementById('timeSlots'); const grid=document.getElementById('timeGrid');
    container.classList.remove('hidden'); grid.innerHTML="";
    const slots=["09:00","10:30","12:00","13:30","15:00"];
    slots.forEach(hour=>{
        const div=document.createElement('div'); div.textContent=hour; div.className='slot';
        const reservedIndex = reservations.findIndex(r=>r.jour===day && r.heure===hour);
        if(reservedIndex!==-1){
            div.classList.add("reserved");
            div.addEventListener('click',()=>{
                if(confirm("Voulez-vous annuler cette r√©servation ?")){
                    reservations.splice(reservedIndex,1);
                    localStorage.setItem('reservations', JSON.stringify(reservations));
                    generateAdminTable(); showTimeSlots(day);
                }
            });
        } else {
            div.addEventListener('click',()=>{
                if(confirm("Bloquer ce cr√©neau pour indisponibilit√© ?")){
                    reservations.push({jour:day,heure:hour,nom:"Indisponible",email:"",message:""});
                    localStorage.setItem('reservations', JSON.stringify(reservations));
                    generateAdminTable(); showTimeSlots(day);
                }
            });
        }
        grid.appendChild(div);
    });
}

// --- Tableau R√©servations ---
function generateAdminTable(){
    const tbody=document.getElementById('adminTable'); tbody.innerHTML="";
    reservations.forEach((r,index)=>{
        const tr=document.createElement('tr');
        tr.innerHTML=`<td>${r.jour}</td><td>${r.heure}</td><td>${r.nom}</td><td>${r.email}</td><td>${r.message}</td>
        <td><button style="background:#ff5555;color:white;border:none;border-radius:6px;cursor:pointer;" onclick="cancelByAdmin(${index})">Annuler</button></td>`;
        tbody.appendChild(tr);
    });
}

// --- Annuler depuis tableau ---
function cancelByAdmin(index){ if(confirm("Voulez-vous vraiment annuler cette r√©servation ?")){ reservations.splice(index,1); localStorage.setItem('reservations',JSON.stringify(reservations)); generateAdminTable(); if(selectedDay) showTimeSlots(selectedDay); } }

// --- Annonces ---
function publishAnnouncement(){
    const msg=document.getElementById('announcementText').value.trim();
    if(msg===""){ alert("√âcrire un message."); return; }
    announcements.push(msg); localStorage.setItem('announcements', JSON.stringify(announcements));
    document.getElementById('announcementText').value=''; displayAnnouncements();
}

function displayAnnouncements(){
    const ul=document.getElementById('announcementList'); ul.innerHTML="";
    announcements.forEach((a,index)=>{
        const li=document.createElement('li'); li.textContent = a + " ";
        const btn = document.createElement('button');
        btn.textContent = "Supprimer";
        btn.style.background = "#ff5555"; btn.style.color = "white"; btn.style.border = "none";
        btn.style.borderRadius = "5px"; btn.style.marginLeft = "10px"; btn.style.cursor = "pointer";
        btn.onclick = ()=>{ if(confirm("Supprimer ce message ?")){ announcements.splice(index,1); localStorage.setItem('announcements', JSON.stringify(announcements)); displayAnnouncements(); } };
        li.appendChild(btn); ul.appendChild(li);
    });
}

// --- Message de bienvenue ---
function setWelcomeMessage(){
    const msg = document.getElementById('welcomeText').value.trim();
    localStorage.setItem('welcomeMessage', msg);
    displayWelcomeMessage();
}

function displayWelcomeMessage(){
    const msg = localStorage.getItem('welcomeMessage') || "";
    document.getElementById('currentWelcome').textContent = msg;
}
</script>
</body>
</html>

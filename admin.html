<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Shadi Piscine - Admin</title>
<style>
body { font-family: Arial; transition:0.3s; background:#f4f4f4; color:#000; }
.dark-mode { background:#121212; color:#fff; }
.container { max-width:700px; margin:auto; padding:20px; }
button { border:none; cursor:pointer; border-radius:5px; padding:8px; margin:5px; }
button:hover { opacity:0.9; }
button.logoutBtn { background:#ff5555; color:white; }
button.cancelBtn { background:#ff9900; color:white; }
.hidden { display:none; }
.calendar { display:grid; grid-template-columns:repeat(7,1fr); gap:5px; margin:10px 0; }
.day { padding:20px; text-align:center; border-radius:8px; border:1px solid #ccc; cursor:pointer; background:white; }
.day:hover { background:#cce5ff; }
.day.blocked { background:#999; color:white; cursor:pointer; }
.day.reserved { background:#ccc; color:#666; cursor:not-allowed; }
table { width:100%; border-collapse:collapse; margin-top:15px;}
th, td { border:1px solid #000; padding:8px; text-align:center;}
</style>
</head>
<body>

<div class="container">
<h2>Admin - Shadi Piscine</h2>
<button class="logoutBtn" onclick="logout()">D√©connexion</button>
<button onclick="toggleMode()">üåô/‚òÄÔ∏è Mode sombre/blanc</button>

<h3>Calendrier Admin - Bloquer/D√©bloquer les jours</h3>
<div class="calendar" id="adminCalendar"></div>
<p>Les jours gris sont bloqu√©s pour les clients.</p>

<h3>R√©servations</h3>
<table>
<tr><th>Jour</th><th>Nom</th><th>Email</th><th>Message</th><th>Action</th></tr>
<tbody id="adminTable"></tbody>
</table>
</div>

<script>
// --- Admin ---
let reservations = JSON.parse(localStorage.getItem('reservations')) || [];
let blockedDays = JSON.parse(localStorage.getItem('blockedDays')) || [];

// --- Mode sombre ---
function toggleMode(){ document.body.classList.toggle('dark-mode'); }

function logout(){
    alert("D√©connexion admin !");
    location.reload();
}

// --- G√©n√©rer calendrier admin ---
function generateAdminCalendar(){
    const calendar = document.getElementById('adminCalendar');
    calendar.innerHTML="";
    for(let day=1; day<=30; day++){
        const div = document.createElement('div');
        div.textContent = day;
        div.className='day';
        if(blockedDays.includes(day)){
            div.classList.add('blocked');
        }
        div.addEventListener('click',()=>{
            if(blockedDays.includes(day)){
                blockedDays = blockedDays.filter(d => d!==day);
                div.classList.remove('blocked');
            } else {
                blockedDays.push(day);
                div.classList.add('blocked');
            }
            localStorage.setItem('blockedDays', JSON.stringify(blockedDays));
            generateCalendarClients(); // Mettre √† jour les jours r√©serv√©s c√¥t√© client
        });
        calendar.appendChild(div);
    }
}

// --- G√©n√©rer tableau r√©servations ---
function generateAdminTable(){
    const tbody = document.getElementById('adminTable');
    tbody.innerHTML="";
    reservations.forEach((r,index)=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${r.jour}</td><td>${r.nom}</td><td>${r.email}</td><td>${r.message}</td>
        <td><button class="cancelBtn" onclick="cancelReservation(${index})">Annuler</button></td>`;
        tbody.appendChild(tr);
    });
}

function cancelReservation(index){
    if(confirm("Voulez-vous vraiment annuler cette r√©servation ?")){
        reservations[index].annule = true;
        localStorage.setItem('reservations', JSON.stringify(reservations));
        generateAdminTable();
        alert("R√©servation annul√©e ! Le client sera inform√© √† sa prochaine connexion.");
    }
}

// --- Fonction pour synchroniser le calendrier client avec les jours bloqu√©s ---
function generateCalendarClients(){
    const calendar = document.getElementById('adminCalendar');
    const clientCalendar = document.getElementById('adminCalendar'); // Pour simuler c√¥t√© client
    // En vrai c√¥t√© client, le script client lit blockedDays pour afficher jours gris
}

// --- Initialisation ---
generateAdminCalendar();
generateAdminTable();
</script>
</body>
</html>
